<!DOCTYPE html><html><head><meta charset="utf-8"><title>Logging all unhandled exceptions in .NET | Naeem Khedarun</title><meta name="author" content="Naeem Khedarun"><meta name="description" content="With most applications its easy to get started on logging. However this will not log unhandled exceptions from places you couldn&#39;t forsee. So let&#39;s log these just in case anything goes wrong."><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:title" content="Logging all unhandled exceptions in .NET"><meta property="og:site_name" content="Naeem Khedarun"><meta property="og:image" content="http://naeem.khedarun.co.uk/blog/images/code-cover.png"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://naeem.khedarun.co.uk/blog/images/code-cover.png"><meta property="og:description" content="With most applications its easy to get started on logging. However this will not log unhandled exceptions from places you couldn&#39;t forsee. So let&#39;s log these just in case anything goes wrong."><meta name="twitter:description" content="With most applications its easy to get started on logging. However this will not log unhandled exceptions from places you couldn&#39;t forsee. So let&#39;s log these just in case anything goes wrong."><meta property="og:url" content="http://naeem.khedarun.co.uk/blog/blog/2016/01/05/logging-all-unhandled-exceptions-in-dotnet-1452008814097/"><meta name="twitter:site" content="@NaeemKhedarun"><meta name="twitter:creator" content="@NaeemKhedarun"><meta name="twitter:title" content="Logging all unhandled exceptions in .NET"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png"><link rel="alternate" href="/blog/atom.xml" title="Naeem Khedarun" type="application/atom+xml"><link rel="stylesheet" href="/css/all-79248e3d39.min.css"><script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart']}]}"></script></head><body><div id="wrap"><div class="navbar navbar-static-top" role="navigation"><div class="container"><div class="col-12 navbar-center"><a href="/blog/"><span class="name-brand">Naeem Khedarun</span></a> <span class="navbar-spacer"></span> <span><a href="https://twitter.com/naeemkhedarun"><i class="fa fa-twitter"></i></a> <a href="https://github.com/naeemkhedarun"><i class="fa fa-github"></i></a> <a href="https://uk.linkedin.com/in/naeemkhedarun"><i class="fa fa-linkedin-square"></i></a> <a href="/blog/atom.xml"><i class="fa fa-rss"></i></a></span></div></div></div><div class="container"><div class="row"><div class="col-12 col-md-12"><h1 class="title">Logging all unhandled exceptions in .NET</h1><i>9 months ago</i><p></p><p>With most applications its easy to get started on logging.</p><ul><li>Install a logging framework like NLog or log4net.</li><li>Put try catches around your main program logic and include contextual information with the exception.</li><li>If its a web application use a logging middleware for your web framework.</li></ul><p>However this will not log unhandled exceptions from places you couldn’t forsee. So let’s log these just in case anything goes wrong.</p><p>Any exceptions which crash the application can be handled using the <code>UnhandledException</code> event.</p><figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">AppDomain.CurrentDomain.UnhandledException += (sender, args) =&gt;</div><div class="line">&#123;</div><div class="line">    Log.Exception((Exception)args.ExceptionObject);</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>This will help you diagnose fatal errors. Unfortunately not all exceptions are fatal, and if you have any timers, unawaited async or unhandled task pool exceptions these can cause your application to behave unexpectedly without you knowing about it.</p><p>You can use the UnobservedTaskException to catch some of those ones:</p><figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">TaskScheduler.UnobservedTaskException += (sender, args) =&gt;</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (!args.Observed)</div><div class="line">    &#123;</div><div class="line">        Log.Exception(args.Exception);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>If you know any other events or ways to get more of these unexpected errors please let me know!</p><p></p><div class="categories"><span>Posted in: </span><a href="/blog/categories/development/">development</a></div><div class="tags"><span>Tagged with: </span><a href="/blog/tags/NET/">.NET</a>, <a href="/blog/tags/C/">C#</a></div><br><hr><div class="row"><div class="col-md-12"><h3>Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div></div></div><div id="push"></div></div><div id="footer"><div class="container"><div class="container"><br><p class="muted credit">&copy; 2016 Naeem Khedarun</p></div></div></div><script src="/js/all-8d7c4a0adc.min.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-71815871-1', 'auto');
ga('send', 'pageview');</script><script type="text/javascript">var disqus_shortname = 'naeemkhedarun';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());</script></body></html>