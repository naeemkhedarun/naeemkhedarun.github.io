<!DOCTYPE html><html><head><meta charset="utf-8"><title>OctoSearch - Cache and search Octopus Deploy variable sets | Naeem Khedarun</title><meta name="author" content="Naeem Khedarun"><meta name="description" content="When putting together new deployments the octopus deploy interface does a great job. Unfortunately, when you have hundreds of deployments and thousand"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:title" content="OctoSearch - Cache and search Octopus Deploy variable sets"><meta property="og:site_name" content="Naeem Khedarun"><meta property="og:image" content="http://naeem.khedarun.co.uk/blog/images/code-cover.png"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://naeem.khedarun.co.uk/blog/images/code-cover.png"><meta property="og:url" content="http://naeem.khedarun.co.uk/blog/blog/2017/01/11/octosearch-cache-and-search-octopus-deploy-variable-sets-1484135933380/"><meta name="twitter:site" content="@NaeemKhedarun"><meta name="twitter:creator" content="@NaeemKhedarun"><meta name="twitter:title" content="OctoSearch - Cache and search Octopus Deploy variable sets"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png"><link rel="alternate" href="/blog/atom.xml" title="Naeem Khedarun" type="application/atom+xml"><link rel="stylesheet" href="/css/all-de3b3b87da.min.css"><script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart']}]}"></script></head><body><div id="wrap"><div class="navbar navbar-static-top" role="navigation"><div class="container"><div class="col-12 navbar-center"><a href="/blog/"><span class="name-brand">Naeem Khedarun</span></a> <span class="navbar-spacer"></span> <span><a href="https://twitter.com/naeemkhedarun"><i class="fa fa-twitter"></i></a> <a href="https://github.com/naeemkhedarun"><i class="fa fa-github"></i></a> <a href="https://uk.linkedin.com/in/naeemkhedarun"><i class="fa fa-linkedin-square"></i></a> <a href="/blog/atom.xml"><i class="fa fa-rss"></i></a></span></div></div></div><div class="container"><div class="row"><div class="col-12 col-md-12"><h1 class="title">OctoSearch - Cache and search Octopus Deploy variable sets</h1><i>3 months ago</i><p></p><p>When putting together new deployments the <a href="https://octopus.com/" target="_blank" rel="external">octopus deploy</a> interface does a great job. Unfortunately, when you have hundreds of deployments and thousands of variables it can become difficult to find and navigate the variables without search and filter functions.</p><p>As a stop-gap to Octopus hopefully adding this feature I’ve created <a href="https://github.com/naeemkhedarun/OctoSearch" target="_blank" rel="external">OctoSearch</a>. This allows you to download and cache the variable sets with their variable collections locally as Text, Json or Html.</p><p>OctoSearch itself is a package available from nuget. It has been compiled down to a native executable so a dotnet core installation is not needed.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; nuget install OctoSearch</div><div class="line">&gt; cd .\tools\OctoSearch*\tools</div><div class="line">&gt; .\OctoSearch.exe</div></pre></td></tr></table></figure><p>The first step is to login with the octopus server so we can create, download and cache an API token. This will be used for subsequent calls to octopus.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe login -l https://octopus/ -u username</div><div class="line">Please enter your password...</div><div class="line">*********</div><div class="line">Successfully logged in.</div></pre></td></tr></table></figure><p>Now that we’re authenticated we can download and cache the variable sets and their variable collections. This cache will be used for our searches to reduce the load on the Octopus server. Variables marked as sensitive won’t have their values downloaded or cached; their variable names will be searchable but not their values.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe cache</div><div class="line">Saved LibraryVariableSet1.</div><div class="line">Saved LibraryVariableSet2.</div><div class="line">...</div></pre></td></tr></table></figure><p>With the variables cached locally you can run fast searches and regenerate them into either Json or Html documents. To run a basic command line search you can use the search verb. It takes a regex so you can pass in basic text or more advanced text searches when you need to.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe search --regex connectionstring</div><div class="line">Database.ConnectionString            ConnectionStringOne</div><div class="line">ServiceBus.ConnectionString          ConnectionStringTwo</div></pre></td></tr></table></figure><p>To output the search results into a text file you can do:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe search --regex connectionstring --output-file results.txt</div></pre></td></tr></table></figure><p>To display all the variables in a html report we omit the regex to default to a greedy regex \w.. The html report has a client side search facility to filter variables for easier exploration.</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe search --output-file results.html --output-format html</div></pre></td></tr></table></figure><p>This will give you a search UI that looks like:</p><p><img src="https://github.com/naeemkhedarun/OctoSearch/raw/master/wiki/images/html-report.png" alt="search report"></p><p>If you would prefer it in Json:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; .\OctoSearch.exe search  --output-file results.json --output-format json</div></pre></td></tr></table></figure><p>Once we have it in Json we can load and analyse it within powershell. For example to get all the variables marked as <code>IsSensitive</code> we could do:</p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt; $variablesets = ConvertFrom-Json (gc -Raw .\results.json)</div><div class="line">&gt; ($variablesets | % &#123; $_.Variables &#125; | ? &#123; $_.IsSensitive &#125;).length</div><div class="line">300</div></pre></td></tr></table></figure><p>If you have any feedback or feature requests you can <a href="https://github.com/naeemkhedarun/OctoSearch/issues" target="_blank" rel="external">create an issue</a> or reach me <a href="https://twitter.com/NaeemKhedarun" target="_blank" rel="external">@naeemkhedarun</a>.</p><p></p><div class="categories"><span>Posted in: </span><a href="/blog/categories/operations/">operations</a></div><div class="tags"><span>Tagged with: </span><a href="/blog/tags/powershell/">powershell</a>, <a href="/blog/tags/octopus/">octopus</a></div><br><hr><div class="row"><div class="col-md-12"><h3>Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div></div></div><div id="push"></div></div><div id="footer"><div class="container"><div class="container"><br><p class="muted credit">&copy; 2017 Naeem Khedarun</p></div></div></div><script src="/js/all-8d7c4a0adc.min.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-71815871-1', 'auto');
ga('send', 'pageview');</script><script type="text/javascript">var disqus_shortname = 'naeemkhedarun';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());</script></body></html>